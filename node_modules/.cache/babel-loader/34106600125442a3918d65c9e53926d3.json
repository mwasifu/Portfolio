{"ast":null,"code":"import { Scene as e, OrthographicCamera as t, WebGLRenderer as n, TextureLoader as i, LinearFilter as o, VideoTexture as a, ShaderMaterial as r, Vector4 as s, PlaneBufferGeometry as f, Mesh as l } from \"three\";\nimport d from \"gsap/TweenMax\";\nexport default function (v) {\n  function u() {\n    for (var e = arguments, t = 0; t < arguments.length; t++) if (void 0 !== e[t]) return e[t];\n  }\n\n  console.log(\"%c Hover effect by Robin Delaporte: https://github.com/robin-dela/hover-effect \", \"color: #bada55; font-size: 0.8rem\");\n  var m = v.parent,\n      p = v.displacementImage,\n      c = v.image1,\n      g = v.image2,\n      h = u(v.imagesRatio, 1),\n      y = u(v.intensity1, v.intensity, 1),\n      x = u(v.intensity2, v.intensity, 1),\n      F = u(v.angle, Math.PI / 4),\n      w = u(v.angle1, F),\n      H = u(v.angle2, 3 * -F),\n      W = u(v.speedIn, v.speed, 1.6),\n      E = u(v.speedOut, v.speed, 1.2),\n      P = u(v.hover, !0),\n      U = u(v.easing, Expo.easeOut),\n      C = u(v.video, !1);\n  if (m) {\n    if (c && g && p) {\n      var D = new e(),\n          L = new t(m.offsetWidth / -2, m.offsetWidth / 2, m.offsetHeight / 2, m.offsetHeight / -2, 1, 1e3);\n      L.position.z = 1;\n      var M = new n({\n        antialias: !1,\n        alpha: !0\n      });\n      M.setPixelRatio(2), M.setClearColor(16777215, 0), M.setSize(m.offsetWidth, m.offsetHeight), m.appendChild(M.domElement);\n\n      var R = function () {\n        M.render(D, L);\n      },\n          V = new i();\n\n      V.crossOrigin = \"\";\n\n      var _,\n          z,\n          b = V.load(p, R);\n\n      if (b.magFilter = b.minFilter = o, C) {\n        var O = function () {\n          requestAnimationFrame(O), M.render(D, L);\n        };\n\n        O(), (C = document.createElement(\"video\")).autoplay = !0, C.loop = !0, C.src = c, C.load();\n        var S = document.createElement(\"video\");\n        S.autoplay = !0, S.loop = !0, S.src = g, S.load();\n        var I = new a(C),\n            j = new a(S);\n        I.magFilter = j.magFilter = o, I.minFilter = j.minFilter = o, S.addEventListener(\"loadeddata\", function () {\n          S.play(), (j = new a(S)).magFilter = o, j.minFilter = o, A.uniforms.texture2.value = j;\n        }, !1), C.addEventListener(\"loadeddata\", function () {\n          C.play(), (I = new a(C)).magFilter = o, I.minFilter = o, A.uniforms.texture1.value = I;\n        }, !1);\n      } else I = V.load(c, R), j = V.load(g, R), I.magFilter = j.magFilter = o, I.minFilter = j.minFilter = o;\n\n      var q = h;\n      m.offsetHeight / m.offsetWidth < q ? (_ = 1, z = m.offsetHeight / m.offsetWidth / q) : (_ = m.offsetWidth / m.offsetHeight * q, z = 1);\n      var A = new r({\n        uniforms: {\n          intensity1: {\n            type: \"f\",\n            value: y\n          },\n          intensity2: {\n            type: \"f\",\n            value: x\n          },\n          dispFactor: {\n            type: \"f\",\n            value: 0\n          },\n          angle1: {\n            type: \"f\",\n            value: w\n          },\n          angle2: {\n            type: \"f\",\n            value: H\n          },\n          texture1: {\n            type: \"t\",\n            value: I\n          },\n          texture2: {\n            type: \"t\",\n            value: j\n          },\n          disp: {\n            type: \"t\",\n            value: b\n          },\n          res: {\n            type: \"vec4\",\n            value: new s(m.offsetWidth, m.offsetHeight, _, z)\n          },\n          dpr: {\n            type: \"f\",\n            value: window.devicePixelRatio\n          }\n        },\n        vertexShader: \"\\nvarying vec2 vUv;\\nvoid main() {\\n  vUv = uv;\\n  gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\\n}\\n\",\n        fragmentShader: \"\\nvarying vec2 vUv;\\n\\nuniform float dispFactor;\\nuniform float dpr;\\nuniform sampler2D disp;\\n\\nuniform sampler2D texture1;\\nuniform sampler2D texture2;\\nuniform float angle1;\\nuniform float angle2;\\nuniform float intensity1;\\nuniform float intensity2;\\nuniform vec4 res;\\nuniform vec2 parent;\\n\\nmat2 getRotM(float angle) {\\n  float s = sin(angle);\\n  float c = cos(angle);\\n  return mat2(c, -s, s, c);\\n}\\n\\nvoid main() {\\n  vec4 disp = texture2D(disp, vUv);\\n  vec2 dispVec = vec2(disp.r, disp.g);\\n\\n  vec2 uv = 0.5 * gl_FragCoord.xy / (res.xy) ;\\n  vec2 myUV = (uv - vec2(0.5))*res.zw + vec2(0.5);\\n\\n\\n  vec2 distortedPosition1 = myUV + getRotM(angle1) * dispVec * intensity1 * dispFactor;\\n  vec2 distortedPosition2 = myUV + getRotM(angle2) * dispVec * intensity2 * (1.0 - dispFactor);\\n  vec4 _texture1 = texture2D(texture1, distortedPosition1);\\n  vec4 _texture2 = texture2D(texture2, distortedPosition2);\\n  gl_FragColor = mix(_texture1, _texture2, dispFactor);\\n}\\n\",\n        transparent: !0,\n        opacity: 1\n      }),\n          T = new f(m.offsetWidth, m.offsetHeight, 1),\n          k = new l(T, A);\n      D.add(k), P && (m.addEventListener(\"mouseenter\", B), m.addEventListener(\"touchstart\", B), m.addEventListener(\"mouseleave\", G), m.addEventListener(\"touchend\", G)), window.addEventListener(\"resize\", function (e) {\n        m.offsetHeight / m.offsetWidth < q ? (_ = 1, z = m.offsetHeight / m.offsetWidth / q) : (_ = m.offsetWidth / m.offsetHeight * q, z = 1), k.material.uniforms.res.value = new s(m.offsetWidth, m.offsetHeight, _, z), M.setSize(m.offsetWidth, m.offsetHeight), R();\n      }), this.next = B, this.previous = G;\n    } else console.warn(\"One or more images are missing\");\n  } else console.warn(\"Parent missing\");\n\n  function B() {\n    d.to(A.uniforms.dispFactor, W, {\n      value: 1,\n      ease: U,\n      onUpdate: R,\n      onComplete: R\n    });\n  }\n\n  function G() {\n    d.to(A.uniforms.dispFactor, E, {\n      value: 0,\n      ease: U,\n      onUpdate: R,\n      onComplete: R\n    });\n  }\n}","map":{"version":3,"sources":["../src/hover-effect.js"],"names":["opts","console","log","firstDefined","i","arguments","length","undefined","parent","dispImage","displacementImage","image1","image2","imagesRatio","intensity1","intensity","intensity2","commonAngle","angle","Math","PI","angle1","angle2","speedIn","speed","speedOut","userHover","hover","easing","Expo","easeOut","video","warn","scene","THREE","camera","offsetWidth","offsetHeight","position","z","renderer","antialias","alpha","setPixelRatio","setClearColor","setSize","appendChild","domElement","render","loader","crossOrigin","disp","load","magFilter","minFilter","animate","requestAnimationFrame","document","createElement","autoplay","loop","src","video2","texture1","texture2","addEventListener","play","mat","uniforms","value","a1","a2","imageAspect","type","dispFactor","res","dpr","window","devicePixelRatio","vertexShader","fragmentShader","transparent","opacity","geometry","object","add","transitionIn","TweenMax","to","ease","onUpdate","onComplete","transitionOut","e","material","next","previous"],"mappings":"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","sourcesContent":["import * as THREE from 'three';\nimport TweenMax from 'gsap/TweenMax';\n\nexport default function (opts) {\n\n  var vertex = `\nvarying vec2 vUv;\nvoid main() {\n  vUv = uv;\n  gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}\n`;\n\n  var fragment = `\nvarying vec2 vUv;\n\nuniform float dispFactor;\nuniform float dpr;\nuniform sampler2D disp;\n\nuniform sampler2D texture1;\nuniform sampler2D texture2;\nuniform float angle1;\nuniform float angle2;\nuniform float intensity1;\nuniform float intensity2;\nuniform vec4 res;\nuniform vec2 parent;\n\nmat2 getRotM(float angle) {\n  float s = sin(angle);\n  float c = cos(angle);\n  return mat2(c, -s, s, c);\n}\n\nvoid main() {\n  vec4 disp = texture2D(disp, vUv);\n  vec2 dispVec = vec2(disp.r, disp.g);\n\n  vec2 uv = 0.5 * gl_FragCoord.xy / (res.xy) ;\n  vec2 myUV = (uv - vec2(0.5))*res.zw + vec2(0.5);\n\n\n  vec2 distortedPosition1 = myUV + getRotM(angle1) * dispVec * intensity1 * dispFactor;\n  vec2 distortedPosition2 = myUV + getRotM(angle2) * dispVec * intensity2 * (1.0 - dispFactor);\n  vec4 _texture1 = texture2D(texture1, distortedPosition1);\n  vec4 _texture2 = texture2D(texture2, distortedPosition2);\n  gl_FragColor = mix(_texture1, _texture2, dispFactor);\n}\n`;\n\n  // please respect authorship and do not remove\n  console.log('%c Hover effect by Robin Delaporte: https://github.com/robin-dela/hover-effect ', 'color: #bada55; font-size: 0.8rem');\n\n\n  function firstDefined() {\n    for (var i = 0; i < arguments.length; i++) {\n      if (arguments[i] !== undefined) return arguments[i];\n    }\n  }\n\n  var parent = opts.parent;\n  var dispImage = opts.displacementImage;\n  var image1 = opts.image1;\n  var image2 = opts.image2;\n  var imagesRatio = firstDefined(opts.imagesRatio, 1.0);\n  var intensity1 = firstDefined(opts.intensity1, opts.intensity, 1);\n  var intensity2 = firstDefined(opts.intensity2, opts.intensity, 1);\n  var commonAngle = firstDefined(opts.angle, Math.PI / 4); // 45 degrees by default, so grayscale images work correctly\n  var angle1 = firstDefined(opts.angle1, commonAngle);\n  var angle2 = firstDefined(opts.angle2, -commonAngle * 3);\n  var speedIn = firstDefined(opts.speedIn, opts.speed, 1.6);\n  var speedOut = firstDefined(opts.speedOut, opts.speed, 1.2);\n  var userHover = firstDefined(opts.hover, true);\n  var easing = firstDefined(opts.easing, Expo.easeOut);\n  var video = firstDefined(opts.video, false);\n\n  if (!parent) {\n    console.warn('Parent missing');\n    return;\n  }\n\n  if (!(image1 && image2 && dispImage)) {\n    console.warn('One or more images are missing');\n    return;\n  }\n\n  var scene = new THREE.Scene();\n  var camera = new THREE.OrthographicCamera(\n    parent.offsetWidth / -2,\n    parent.offsetWidth / 2,\n    parent.offsetHeight / 2,\n    parent.offsetHeight / -2,\n    1,\n    1000\n  );\n\n  camera.position.z = 1;\n\n  var renderer = new THREE.WebGLRenderer({\n    antialias: false,\n    alpha: true\n  });\n\n  renderer.setPixelRatio(2.0);\n  renderer.setClearColor(0xffffff, 0.0);\n  renderer.setSize(parent.offsetWidth, parent.offsetHeight);\n  parent.appendChild(renderer.domElement);\n\n  var render = function () {\n    // This will be called by the TextureLoader as well as TweenMax.\n    renderer.render(scene, camera);\n  };\n\n  var loader = new THREE.TextureLoader();\n  loader.crossOrigin = '';\n\n  var disp = loader.load(dispImage, render);\n  disp.magFilter = disp.minFilter = THREE.LinearFilter;\n\n  if (video) {\n    var animate = function() {\n        requestAnimationFrame(animate);\n\n        renderer.render(scene, camera);\n    };\n    animate();\n\n    var video = document.createElement('video');\n    video.autoplay = true;\n    video.loop = true;\n    video.src = image1;\n    video.load();\n\n    var video2 = document.createElement('video');\n    video2.autoplay = true;\n    video2.loop = true;\n    video2.src = image2;\n    video2.load();\n\n    var texture1 = new THREE.VideoTexture(video);\n    var texture2 = new THREE.VideoTexture(video2);\n    texture1.magFilter = texture2.magFilter = THREE.LinearFilter;\n    texture1.minFilter = texture2.minFilter = THREE.LinearFilter;\n\n    video2.addEventListener('loadeddata', function() {\n      video2.play();\n\n      texture2 = new THREE.VideoTexture(video2);\n      texture2.magFilter = THREE.LinearFilter;\n      texture2.minFilter = THREE.LinearFilter;\n\n      mat.uniforms.texture2.value = texture2;\n\n    }, false);\n\n    video.addEventListener('loadeddata', function() {\n      video.play();\n\n      texture1 = new THREE.VideoTexture(video);\n\n      texture1.magFilter = THREE.LinearFilter;\n      texture1.minFilter = THREE.LinearFilter;\n\n      mat.uniforms.texture1.value = texture1;\n    }, false);\n  } else {\n    var texture1 = loader.load(image1, render);\n    var texture2 = loader.load(image2, render);\n\n    texture1.magFilter = texture2.magFilter = THREE.LinearFilter;\n    texture1.minFilter = texture2.minFilter = THREE.LinearFilter;\n  }\n\n  let a1, a2;\n  var imageAspect = imagesRatio;\n  if (parent.offsetHeight / parent.offsetWidth < imageAspect) {\n    a1 = 1;\n    a2 = parent.offsetHeight / parent.offsetWidth / imageAspect;\n  } else {\n    a1 = (parent.offsetWidth / parent.offsetHeight) * imageAspect;\n    a2 = 1;\n  }\n\n  var mat = new THREE.ShaderMaterial({\n    uniforms: {\n      intensity1: {\n        type: 'f',\n        value: intensity1\n      },\n      intensity2: {\n        type: 'f',\n        value: intensity2\n      },\n      dispFactor: {\n        type: 'f',\n        value: 0.0\n      },\n      angle1: {\n        type: 'f',\n        value: angle1\n      },\n      angle2: {\n        type: 'f',\n        value: angle2\n      },\n      texture1: {\n        type: 't',\n        value: texture1\n      },\n      texture2: {\n        type: 't',\n        value: texture2\n      },\n      disp: {\n        type: 't',\n        value: disp\n      },\n      res: {\n        type: 'vec4',\n        value: new THREE.Vector4(parent.offsetWidth, parent.offsetHeight, a1, a2)\n      },\n      dpr: {\n        type: 'f',\n        value: window.devicePixelRatio\n      }\n    },\n\n    vertexShader: vertex,\n    fragmentShader: fragment,\n    transparent: true,\n    opacity: 1.0,\n  });\n\n  var geometry = new THREE.PlaneBufferGeometry(parent.offsetWidth, parent.offsetHeight, 1);\n  var object = new THREE.Mesh(geometry, mat);\n  scene.add(object);\n\n  function transitionIn() {\n    TweenMax.to(mat.uniforms.dispFactor, speedIn, {\n      value: 1,\n      ease: easing,\n      onUpdate: render,\n      onComplete: render,\n    });\n  }\n\n  function transitionOut() {\n    TweenMax.to(mat.uniforms.dispFactor, speedOut, {\n      value: 0,\n      ease: easing,\n      onUpdate: render,\n      onComplete: render,\n    });\n  }\n\n  if (userHover) {\n    parent.addEventListener('mouseenter', transitionIn);\n    parent.addEventListener('touchstart', transitionIn);\n    parent.addEventListener('mouseleave', transitionOut);\n    parent.addEventListener('touchend', transitionOut);\n  }\n\n  window.addEventListener('resize', function (e) {\n    if (parent.offsetHeight / parent.offsetWidth < imageAspect) {\n      a1 = 1;\n      a2 = parent.offsetHeight / parent.offsetWidth / imageAspect;\n    } else {\n      a1 = (parent.offsetWidth / parent.offsetHeight) * imageAspect;\n      a2 = 1;\n    }\n    object.material.uniforms.res.value = new THREE.Vector4(parent.offsetWidth, parent.offsetHeight, a1, a2);\n    renderer.setSize(parent.offsetWidth, parent.offsetHeight);\n\n    render()\n  });\n\n  this.next = transitionIn;\n  this.previous = transitionOut;\n};\n"]},"metadata":{},"sourceType":"module"}